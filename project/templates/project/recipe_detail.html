{% extends "project/base.html" %}

{% block title %}
    {{ recipe.name }}
{% endblock %}

{% block content %}
<div style="display: flex; align-items: flex-start;">
    <div style="flex: 1; margin-right: 20px;">
        {% for image in recipe.get_image %}
            <img src="{{ image.img.url }}" alt="{{ recipe.name }}'s Image">
        {% endfor %}
        
        <h3>Ingredients:</h3>
        <ul>
            {% for ingredient in recipe.get_ingredients %}
                <li>{{ ingredient.quantity }} of {{ ingredient.ingredient.name }}</li>
            {% endfor %}
        </ul>
    </div>

    <div style="flex: 2;">
        <h1>{{ recipe.name }}</h1>
        <h3>Description:</h3>
        <form method="post">
            {% csrf_token %}
            <ul style="list-style-type: none; padding: 0;">
                {% for line in recipe.description.splitlines %}
                    <li>
                        <label>
                            <input type="checkbox" class="description-checkbox" name="description_lines" value="{{ line }}"> {{ line }}
                        </label>
                    </li>
                {% endfor %}
            </ul>
            <button type="submit" id="submit-button" style="display: none;" disabled>Submit</button>
        </form>
    </div>
</div>

<script>
    function checkCheckboxes() {
        const checkboxes = document.querySelectorAll('.description-checkbox');
        const submitButton = document.getElementById('submit-button');
        
        if (Array.from(checkboxes).every(checkbox => checkbox.checked)) {
            submitButton.style.display = 'inline-block'; 
            submitButton.disabled = false; 
        } else {
            submitButton.style.display = 'none';
            submitButton.disabled = true;
        }
    }

    document.querySelectorAll('.description-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', checkCheckboxes);
    });
</script>
{% endblock %}
